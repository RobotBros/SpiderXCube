#include "nokia5110.h"  
#include "stddef.h"

 static u8 lcd_bl_flag_100ms = 0;

const u8  font6x8[][6] =      //6*8字符
{
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },// sp
{ 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },// !
{ 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },// "
{ 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },// #
{ 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },// $
{ 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },// %
{ 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },// &
{ 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },// '
{ 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },// (
{ 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },// )
{ 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },// *
{ 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },// +
{ 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },// ,
{ 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },// -
{ 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },// .
{ 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },// /
{ 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },// 0
{ 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },// 1
{ 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },// 2
{ 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },// 3
{ 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },// 4
{ 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },// 5
{ 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },// 6
{ 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },// 7
{ 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },// 8
{ 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },// 9
{ 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },// :
{ 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },// ;
{ 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },// <
{ 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },// =
{ 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },// >
{ 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },// ?
{ 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },// @
{ 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },// A
{ 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },// B
{ 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },// C
{ 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },// D
{ 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },// E
{ 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },// F
{ 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },// G
{ 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },// H
{ 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },// I
{ 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },// J
{ 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },// K
{ 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },// L
{ 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },// M
{ 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },// N
{ 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },// O
{ 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },// P
{ 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },// Q
{ 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },// R
{ 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },// S
{ 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },// T
{ 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },// U
{ 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },// V
{ 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },// W
{ 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },// X
{ 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },// Y
{ 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },// Z
{ 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },// [
{ 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },// 55
{ 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },// ]
{ 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },// ^
{ 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },// _
{ 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },// '
{ 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },// a
{ 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },// b
{ 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },// c
{ 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },// d
{ 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },// e
{ 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },// f
{ 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },// g
{ 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },// h
{ 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },// i
{ 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },// j
{ 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },// k
{ 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },// l
{ 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },// m
{ 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },// n
{ 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },// o
{ 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },// p
{ 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },// q
{ 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },// r
{ 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },// s
{ 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },// t
{ 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },// u
{ 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },// v
{ 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },// w
{ 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },// x
{ 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },// y
{ 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },// z
{ 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }// horiz lines
}; 

/*--  调入了一幅图像：robotbros-48_48.bmp  --*/
/*--  宽度x高度=48x48  --*/
//u8 logo[] =    		//48* 48
//{
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0xFC,0xFE,0x07,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
//0x03,0x83,0xC3,0xE3,0x73,0x33,0x33,0x33,0x73,0xE3,0xC3,0x03,0x03,0x07,0xFE,0xFC,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFC,0xF0,0xF0,0xF0,
//0xE0,0xC0,0xC0,0xC0,0x60,0xF0,0xF8,0xFF,0xFF,0xFC,0x78,0x30,0x30,0x30,0x18,0x0C,
//0x07,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0xFF,0xFF,0x80,0x01,0x03,0x0F,0x1F,0x3B,0x37,0x37,0x3B,0x3C,0x1F,0x07,0x01,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xFF,0xFF,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
//0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
//0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x7E,0x12,0x12,0x12,0x7C,0x00,0x38,0x44,0x44,0x44,0x38,0x00,0x7E,
//0x44,0x44,0x7C,0x00,0x38,0x44,0x44,0x44,0x38,0x00,0x7E,0x44,0x00,0x7E,0x4A,0x4A,
//0x5A,0x24,0x00,0x78,0x04,0x04,0x38,0x44,0x44,0x44,0x38,0x00,0x48,0x54,0x34,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
//};

//const u8 shuzi[]={						//8*16字符
///*--  文字:  0  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,

///*--  文字:  1  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x10,0x10,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,

///*--  文字:  2  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x70,0x08,0x08,0x08,0x88,0x70,0x00,0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,

///*--  文字:  3  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x30,0x08,0x88,0x88,0x48,0x30,0x00,0x00,0x18,0x20,0x20,0x20,0x11,0x0E,0x00,

///*--  文字:  4  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0xC0,0x20,0x10,0xF8,0x00,0x00,0x00,0x07,0x04,0x24,0x24,0x3F,0x24,0x00,

///*--  文字:  5  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0xF8,0x08,0x88,0x88,0x08,0x08,0x00,0x00,0x19,0x21,0x20,0x20,0x11,0x0E,0x00,

///*--  文字:  6  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0xE0,0x10,0x88,0x88,0x18,0x00,0x00,0x00,0x0F,0x11,0x20,0x20,0x11,0x0E,0x00,

///*--  文字:  7  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x38,0x08,0x08,0xC8,0x38,0x08,0x00,0x00,0x00,0x00,0x3F,0x00,0x00,0x00,0x00,

///*--  文字:  8  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,

///*--  文字:  9  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x00,0x31,0x22,0x22,0x11,0x0F,0x00,

///*--  文字:  a  --10*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x19,0x24,0x22,0x22,0x22,0x3F,0x20,

///*--  文字:  b  --11*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x08,0xF8,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0x3F,0x11,0x20,0x20,0x11,0x0E,0x00,

///*--  文字:  c  --12*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x00,0x0E,0x11,0x20,0x20,0x20,0x11,0x00,

///*--  文字:  d  --13*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x80,0x80,0x88,0xF8,0x00,0x00,0x0E,0x11,0x20,0x20,0x10,0x3F,0x20,

///*--  文字:  e  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x1F,0x22,0x22,0x22,0x22,0x13,0x00,

///*--  文字:  f  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x80,0x80,0xF0,0x88,0x88,0x88,0x18,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,

///*--  文字:  g  --16*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x6B,0x94,0x94,0x94,0x93,0x60,0x00,

///*--  文字:  h  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x08,0xF8,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,

///*--  文字:  i  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x80,0x98,0x98,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,

///*--  文字:  j  --19*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x80,0x98,0x98,0x00,0x00,0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,

///*--  文字:  k  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x08,0xF8,0x00,0x00,0x80,0x80,0x80,0x00,0x20,0x3F,0x24,0x02,0x2D,0x30,0x20,0x00,

///*--  文字:  l  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x08,0x08,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,

///*--  文字:  m  --22*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x20,0x3F,0x20,0x00,0x3F,0x20,0x00,0x3F,

///*--  文字:  n  --23*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,

///*--  文字:  o  --24*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,

///*--  文字:  p  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x00,0x80,0xFF,0xA1,0x20,0x20,0x11,0x0E,0x00,

///*--  文字:  q  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x0E,0x11,0x20,0x20,0xA0,0xFF,0x80,

///*--  文字:  r  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x20,0x20,0x3F,0x21,0x20,0x00,0x01,0x00,
//																			   
///*--  文字:  s  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x33,0x24,0x24,0x24,0x24,0x19,0x00,

///*--  文字:  t  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x80,0x80,0xE0,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x1F,0x20,0x20,0x00,0x00,

///*--  文字:  u  --30*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20,

///*--  文字:  v  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x00,0x01,0x0E,0x30,0x08,0x06,0x01,0x00,

///*--  文字:  w  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x00,0x80,0x00,0x80,0x80,0x80,0x0F,0x30,0x0C,0x03,0x0C,0x30,0x0F,0x00,

///*--  文字:  x  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x31,0x2E,0x0E,0x31,0x20,0x00,

///*--  文字:  y  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x80,0x81,0x8E,0x70,0x18,0x06,0x01,0x00,

///*--  文字:  z  --35*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x21,0x30,0x2C,0x22,0x21,0x30,0x00,

///*--  文字:  -  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,

///*--  文字:  =  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x00,

///*--  文字:  \  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x0C,0x30,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x06,0x38,0xC0,0x00,

///*--  文字:     --39*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

///*--  文字:  [  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0xFE,0x02,0x02,0x02,0x00,0x00,0x00,0x00,0x7F,0x40,0x40,0x40,0x00,

///*--  文字:  ]  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x02,0x02,0x02,0xFE,0x00,0x00,0x00,0x00,0x40,0x40,0x40,0x7F,0x00,0x00,0x00,

///*--  文字:  ;  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x60,0x00,0x00,0x00,0x00,

///*--  文字:  '  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x10,0x16,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

///*--  文字:  ,  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xB0,0x70,0x00,0x00,0x00,0x00,0x00,

///*--  文字:  .  --45*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,

///*--  文字:  /  --*/
///*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
//0x00,0x00,0x00,0x00,0x80,0x60,0x18,0x04,0x00,0x60,0x18,0x06,0x01,0x00,0x00,0x00,
//};

//const u8 han[]=						//16*16汉字
//{
///*--  文字:  宁  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x00,0x90,0x8C,0x84,0x84,0x84,0x85,0x86,0x84,0x84,0x84,0x84,0x94,0x8E,0x04,0x00,
//0x00,0x00,0x00,0x00,0x00,0x40,0x80,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

///*--  文字:  波  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x10,0x60,0x01,0xE6,0x00,0xF8,0x88,0x88,0x88,0xFF,0x88,0x88,0x88,0x18,0x08,0x00,
//0x04,0x04,0xFF,0x40,0x30,0x8F,0x80,0x41,0x26,0x18,0x18,0x26,0x61,0xC0,0x40,0x00,

///*--  文字:  单  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x00,0x00,0xF8,0x28,0x29,0x2E,0x2A,0xF8,0x28,0x2C,0x2B,0x2A,0xF8,0x00,0x00,0x00,
//0x08,0x08,0x0B,0x09,0x09,0x09,0x09,0xFF,0x09,0x09,0x09,0x09,0x0B,0x08,0x08,0x00,

///*--  文字:  片  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x00,0x00,0x00,0xFE,0x10,0x10,0x10,0x10,0x10,0x1F,0x10,0x10,0x10,0x18,0x10,0x00,
//0x80,0x40,0x30,0x0F,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFF,0x00,0x00,0x00,0x00,

///*--  文字:  机  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x08,0x08,0xC8,0xFF,0x48,0x88,0x08,0x00,0xFE,0x02,0x02,0x02,0xFE,0x00,0x00,0x00,
//0x04,0x03,0x00,0xFF,0x00,0x41,0x30,0x0C,0x03,0x00,0x00,0x00,0x3F,0x40,0x78,0x00,

///*--  文字:  开  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x40,0x42,0x42,0x42,0x42,0xFE,0x42,0x42,0x42,0x42,0xFE,0x42,0x42,0x42,0x42,0x00,
//0x00,0x40,0x20,0x10,0x0C,0x03,0x00,0x00,0x00,0x00,0x7F,0x00,0x00,0x00,0x00,0x00,

///*--  文字:  发  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x00,0x10,0x3E,0x10,0x10,0xF0,0x9F,0x90,0x90,0x92,0x94,0x1C,0x10,0x10,0x10,0x00,
//0x40,0x20,0x10,0x88,0x87,0x41,0x46,0x28,0x10,0x28,0x27,0x40,0xC0,0x40,0x00,0x00,

///*--  文字:  网  --*/
///*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=16x16   --*/
//0x00,0xFE,0x02,0x12,0x22,0xC2,0x22,0x1A,0x22,0x42,0x82,0x72,0x22,0xFE,0x00,0x00,
//0x00,0x7F,0x08,0x04,0x03,0x00,0x03,0x0C,0x04,0x02,0x01,0x26,0x60,0x3F,0x00,0x00,
//};

//LCD  IO初始化
void LCD_Nokia5110_Init(u16 arr,u16 psc)
{	
	GPIO_InitTypeDef GPIO_InitStructure;
	TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;
	TIM_OCInitTypeDef  TIM_OCInitStructure;
	
	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA |RCC_APB2Periph_GPIOB |RCC_APB2Periph_GPIOC | RCC_APB2Periph_AFIO, ENABLE);
	RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE);
//LCD   BL	I/O初始化
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6;						//TIM3_CH1
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP; 	 							
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);	
	
	GPIO_SetBits(GPIOA,GPIO_Pin_6);
//LCD  PC13-RST PC14-CLK 	I/O初始化
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_13 |GPIO_Pin_14;					
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; 	 							
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOC, &GPIO_InitStructure);	
	
	GPIO_SetBits(GPIOC,GPIO_Pin_13);
	GPIO_SetBits(GPIOC,GPIO_Pin_14);
//LCD   PB6-DIN PB7-DC PB8-CE	I/O初始化
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 |GPIO_Pin_7 |GPIO_Pin_8;					
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; 	 							
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOB, &GPIO_InitStructure);	
	
	GPIO_SetBits(GPIOB,GPIO_Pin_6);
	GPIO_SetBits(GPIOB,GPIO_Pin_7);
	GPIO_SetBits(GPIOB,GPIO_Pin_8);

	   //初始化TIM3，频率设置
	TIM_TimeBaseStructure.TIM_Period = arr; 							//设置在下一个更新事件装入活动的自动重装载寄存器周期的值
	TIM_TimeBaseStructure.TIM_Prescaler =psc; 						//设置用来作为TIMx时钟频率除数的预分频值 
	TIM_TimeBaseStructure.TIM_ClockDivision = 0; 						//设置时钟分割:TDTS = Tck_tim
	TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  	//TIM向上计数模式
	TIM_TimeBaseInit(TIM3, &TIM_TimeBaseStructure);				//根据TIM_TimeBaseInitStruct中指定的参数初始化TIMx的时间基数单位
	
	//初始化TIM3  PWM模式设置	 
	TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM1;			//选择定时器模式:TIM脉冲宽度调制模式1 ,计数时输出为高，计数完成输出低
 	TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; 		//比较输出使能
	TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_Low; 			//输出极性:TIM输出比较极性高
	TIM_OC1Init(TIM3, &TIM_OCInitStructure);  						//根据T指定的参数初始化外设TIM3_CH1 

	TIM_OC1PreloadConfig(TIM3, TIM_OCPreload_Enable); 			//使能TIM3 CH2在CCR2上的预装载寄存器
	TIM_Cmd(TIM3, ENABLE);  //使能TIM3

	LCD_init();
}

// LCD BL 占空比设置
void LCD_BL_PWM_duty_set(u8 duty)
{
	u16 ccr;

	ccr = ((LCD_BL_SCALE + 1)  * duty) / 100;

	TIM_SetCompare1(TIM3,ccr);
}

//---------------------------------------
//名称: 使用SPI接口写数据到LCD
//参数：data：写入的数据 command: 1-数据/0-命令
//-----------------------------------------  
void LCD_write_byte(u8 data, u8 command)
{
	u8 cnt;  	
	
	LCD_CE = 0;
	
	if(command) {LCD_DC = 1;}
	else	 {LCD_DC = 0;}
	
	for(cnt=0;cnt<8;cnt++)
	{ 
		if(data & 0x80) {LCD_DIN = 1;}
		else {LCD_DIN = 0;}
		data = data<<1;	
		LCD_CLK = 0;
		LCD_CLK = 1;
		LCD_CLK = 0;		
	}	  
}

//---------------------------------------
//名称: 5110LCD初始化函数
//----------------------------------------- 
void LCD_init(void)
{
	LCD_CE   = 1;
	LCD_RST =  1;
	delay_us(10);
	LCD_RST = 0;
	delay_us(100); 	
  	LCD_RST = 1;
  	delay_us(10);
	
	LCD_write_byte(0x21,0);		//LCD功能设置：芯片活动，水平寻址，使用扩展指令
	LCD_write_byte(0xd0,0);		//设置VOP值，室温下的编程范围为3.00-10.68
								//Vlcd=3.06+(VOP)*0.06,本例VOP为0B0101 0000为十进制的80，Vlcd=7.86V
	LCD_write_byte(0x20,0);		//LCD功能设置：芯片活动，水平寻址，使用基本指令
	LCD_write_byte(0x0C,0);		//设定显示配置:普通模式
	LCD_CE = 1;


}

//----------------------------------
//系统开机画面显示
//-----------------------------------
void LCD_power_on_action(void)
{

	LCD_BL_PWM_duty_set(40);
	LCD_clear();
	LCD_write_logo(14,0,logo,54,56);
	delay_ms(1000);
	delay_ms(1000);
	LCD_clear();
	LCD_logo_write_String(1,1,"  RobotBros ");
	LCD_logo_write_String(1,3," RobotBros.cn ");
	delay_ms(1000);
	delay_ms(1000);
	LCD_clear();
	LCD_logo_write_String(1,0,"Spider_System ");
	LCD_logo_write_String(1,2,"Starting... ");

}

//---------------------------------------
//名称: Logo英文字符串显示函数
//参数：*s：英文字符串指针
//		x: x坐标 y:y坐标 
//-----------------------------------------  
void LCD_write_logo(u8 x,u8 y,u8 *s,u8 pix_x,u8 pix_y)
{
	u16 len;
	u8 row,cnt1,cnt2;

	if(pix_y%8 == 0) {row = pix_y/8;}
	else {row = pix_y/8 + 1;}

	LCD_set_XY(x,y);

	for(cnt1=0;cnt1<row;cnt1++)
	{
		for(cnt2=0;cnt2<pix_x;cnt2++)
		{
			LCD_set_XY(x+cnt2,y+cnt1);
			LCD_write_byte(s[cnt2+cnt1*pix_x],1);
			//delay_ms(50);
		}
		delay_ms(50);
	}
} 

//----------------------------------
//系统故障显示
//-----------------------------------
void LCD_fault_display(u8 fault)
{	
	if(fault == SYSTEM_NRF_NULL)
	{
		LCD_clear();
		LCD_write_String(1,0,"Spider_System ");
		LCD_logo_write_String(1,2,"NRF is NULL! ");
	}
	else if(fault == SYSTEM_VOLTAGE_FAULT)
	{
		LCD_clear();
		LCD_write_String(1,0,"Spider_System ");
		LCD_logo_write_String(1,2,"Battery error! ");

	}
}

//---------------------------------------
//名称: 设置坐标函数
//参数：X：0－83 Y：0－5
//-----------------------------------------   
void LCD_set_XY(u8  x, u8 y)
{
	LCD_write_byte(0x40 | y, 0);	// column
	LCD_write_byte(0x80 | x, 0);	// row
	LCD_CE =1;
} 

//---------------------------------------
//名称: LCD清屏函数
//----------------------------------------- 
void LCD_clear(void)
{
	u8 t,k;

	LCD_set_XY(0,0);
	for(t=0;t<6;t++)
	{ 
		for(k=0;k<84;k++)
		{ 
			LCD_write_byte(0x00,1);	 						
		} 
	}
	LCD_CE = 1;
}

//---------------------------------------
//名称: 显示英文字符
//参数：c：显示的字符在font6x8表格中的位置
//-----------------------------------------  	
void LCD_write_char(u8 c)
{
	u8 line;
	
	c-= 32;
	for (line=0; line<6; line++)
	LCD_write_byte(font6x8[c][line], 1);
}

//---------------------------------------
//名称: 显示单个数字
//参数: x/y:坐标; number:需要显示数字; len:数据位数，最高三位
//---------------------------------------
void LCD_write_number(u8 x,u8 y,u8 number,u8 len)
{
	u8 line;
	u8 single_digit,tens_digit,hundreds;

	LCD_set_XY(x,y);

	hundreds = number / 100;
	tens_digit = number / 10;
	single_digit = number % 10;
	
	if(len == 3)
	{
		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[hundreds+ 16][line], 1);
	
		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[tens_digit + 16][line], 1);

		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[single_digit+ 16][line], 1);

		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[0][line], 1);					//display space
		
	}
	else if(len == 2)
	{
		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[tens_digit + 16][line], 1);

		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[single_digit+ 16][line], 1);

		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[0][line], 1);					//display space
	}
	else if(len == 1)
	{
		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[single_digit+ 16][line], 1);

		for(line=0;line<6;line++)
		LCD_write_byte(font6x8[0][line], 1);					//display space
	}
}

//---------------------------------------
//名称: 英文字符串显示函数
//参数：*s：英文字符串指针
//		x: x坐标 y:y坐标 
//-----------------------------------------  
void LCD_write_String(u8 x,u8 y,char *s)
{
	LCD_set_XY(x,y);
	
	while (*s) 
	{
		LCD_write_char(*s);
		s++;
	}
} 

//---------------------------------------
//名称: Logo英文字符串显示函数
//参数：*s：英文字符串指针
//		x: x坐标 y:y坐标 
//-----------------------------------------  
void LCD_logo_write_String(u8 x,u8 y,char *s)
{
	LCD_set_XY(x,y);
	
	while (*s) 
	{
		LCD_write_char(*s);
		delay_ms(100);
		s++;
	}
} 



//---------------------------------------
//名称: 写一个字符到LCD函数（8*16点阵）
//参数：row,page：写入字符的地址 c: 写入字符在shuzi表格中的位置
//---------------------------------------
//void LCD_write_shu(u8 row, u8 page, u8 c)	//row:列 page:页 dd:字符
//{
//	u8 cnt;  	
//	
//	LCD_set_XY(row*8, page);				// 列，页 
//	for(cnt=0; cnt<8;cnt++) 
//	{
//		LCD_write_byte(shuzi[c*16+cnt],1); 
//	}
//	
//   	 LCD_set_XY(row*8, page+1);				// 列，页 
//	for(cnt=8; cnt<16;cnt++) 
//	{
//		LCD_write_byte(shuzi[c*16+cnt],1);
//	}
//	LCD_CE =1;
//}

//---------------------------------------
//名称: 写一个汉字到LCD函数
//参数：x,y：写入汉字的地址 address: 写入汉字在han表格中的位置
//----------------------------------------- 
//void LCD_write_hanzi(u8 row, u8 page,u8 c)	 //row:列 page:页 dd:字符
//{
//	u8 cnt;  	
//	
//	LCD_set_XY(row*8, page);				// 列，页 
//	for(cnt=0; cnt<16;cnt++) 
//	{
//		LCD_write_byte(han[c*32+cnt],1); 
//	}

//   	 LCD_set_XY(row*8, page+1);				// 列，页 
//	for(cnt=16; cnt<32;cnt++) 
//	{
//		LCD_write_byte(han[c*32+cnt],1);
//	}	
//	LCD_CE = 1;
//}

//------------------------------
//设置LCD背光定时器 100ms
//------------------------------
void LCD_backlight_set_timer(void)
{
	static u8 tick_4ms = 0;

	tick_4ms++;
	
	if (tick_4ms >= 25)			// 4*25 = 100ms
	{	
		tick_4ms=0;
		lcd_bl_flag_100ms = 1;
	}

}

//---------------------------------
//LCD背光自动调节
//---------------------------------
void LCD_backlight_set(void)
{
	if(lcd_bl_flag_100ms)
	{
		lcd_bl_flag_100ms = 0;
		
		if(Pre_photoresistor < 6)
			{LCD_BL_PWM_duty_set(0);}
		else
			{LCD_BL_PWM_duty_set(Pre_photoresistor >> 1);}
	}
}



